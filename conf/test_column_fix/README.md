# Waldorf Column 5 Fix Test Patches

These test patches verify that Column 5 now correctly outputs **gain** (linear) instead of **tune** (cents).

## Test Cases

| File | Volume (dB) | Expected Linear | Test Note |
|------|------------|----------------|-----------|
| `test_col5_gain_negative12db` | -12.0 dB | 0.251189 | C4 (60) |
| `test_col5_gain_0db` | 0.0 dB | 1.000000 | C#4 (61) |
| `test_col5_gain_plus6db` | +6.0 dB | 1.995262 | D4 (62) |
| `test_col5_gain_plus12db` | +12.0 dB | 3.981071 | D#4 (63) |

## Testing Instructions

### Method 1: Using AutosamplerT Scripts
```bash
# Test each patch (requires MIDI/audio setup)
python autosamplerT.py --script conf/test_column_fix/test_col5_gain_0db.yaml --test_mode

# Export to map format
python autosamplerT.py --script conf/test_column_fix/test_col5_gain_0db.yaml --export_formats map
```

### Method 2: Direct SFZ Testing
```bash
# Test direct SFZ export (no sampling needed)
python -c "
from src.export.export_waldorf_sample_map import WaldorfSampleMapExporter
exporter = WaldorfSampleMapExporter(location=2)
exporter.export('output/test_col5', 'test_col5_gain_0db', 'conf/test_column_fix/test_col5_gain_0db.sfz', 'samples')
"
```

## What to Verify

1. **Column 5 values**: Should match expected linear values, not 1.0 (old tune behavior)
2. **dB to Linear conversion**: -12dB ≈ 0.251, 0dB = 1.0, +6dB ≈ 1.995, +12dB ≈ 3.981
3. **No regression**: Other columns should remain unchanged

## Expected Output Format

Before fix (WRONG):
```
"2:samples/test_sample.wav"	60.0	60	60	1.0	1	127	...
```

After fix (CORRECT):
```
"2:samples/test_sample.wav"	60.0	60	60	0.251189	1	127	...
                                        ^^^^^^^ 
                                     Column 5: Gain (linear)
```

## Formula Verification

The conversion formula used: `linear = 10^(dB/20)`

| dB | Formula | Result |
|----|---------|--------|
| -12 | 10^(-12/20) | 0.251189 |
| 0 | 10^(0/20) | 1.000000 |
| +6 | 10^(6/20) | 1.995262 |
| +12 | 10^(12/20) | 3.981071 |

---
*Generated by: test_waldorf_column_fix.py*
*Date: January 16, 2026*
